

**Jay Gordon:** you're listening to the on call nightmares podcast, and every week I bring conversations with technologists who have spent time on call this wee Michael Stahnke from CircleCI, I joined me while I was in De Bob. Steve Chicago Michael is the VP of platform engineering for Circle C. I. Prior that has spent many years with Puppet and has a pretty long and storied career where he's been a really big part of this Dev ops community for as long as I can really call had a really good time Dev Ops Days, Chicago got an opportunity to speak and took part in some open spaces. If you've never been to a Dev Ops days, I really do recommend you spent time in one of these events. You'll find that you'll be able to learn a lot of meat, taught of people and really understand what the community is trying to do. Other than that, I'm going to get into the interview with Michael. But before I do that, you know what I'm gonna do. And that's remind you that it's very easy to be on this podcast. All you gotta do is send me an email on call nightmares at gmail dot com, or you could reach out to me on Twitter. It's at on Call Nightmare or at J Destro. That's my own Twitter account. So without further ado, here is my conversation with Michael. You're listening to the on call nightmares podcast and just about every week, and I'm getting super close to getting it every week again. I bring your conversations with technologists. You've spent time on call, and today I am in Chicago at DevOpsDays got to speak yesterday and one of my fellow speeders, who is also big, magnificent singer at karaoke time. Michael Stocky is here with me. Thank you so much. And you know what? Joining us randomly for the podcast he's just gonna be sitting in and he's been on the podcast before is Jason Ye off Data Dog. Michael joins us also from Circle C. I. So it sounds like we've got, like, a cool little group here. Jason's just kind of gonna be in the background if he wants to chime in because he's holding a sign that says applause and I'll start clapping. There you go. Awesome. You know, I do this podcast because I get lucky to run into so many awesome people. Michael, you're one of them. We met on the road. I think it a dev Ops days. And I've been lucky enough to not only kind of follow some of the stuff you've done, including, you know, you're moving puppet over the circle C I but just, you know, seeing ah, lot of the interesting things that you presented talks on one. I remember very well was your conversation devil upstairs. Denver, I think was last year. Just great stuff. So thank you for coming on the podcast, huh? Thanks for having me. Awesome. Still, the podcast kind of goes like this, and we'll we'll go through it. But first of all, just kind of want to find out. Like, what were you gonna got started? And I guess, tack around. What would you say early two thousands? Yeah. Oh, to go to. So you're you're Connie. Come in post dot com Bubble burst. I came in around the same time. Ah, lot of us were people who they said, Oh, you know how to do a linen. Here's a job s Oh, was that kind of year like you came from a traditional educational Yes,

Michael Stahnke: I C s degree. It was 2002 and I think there were 204 of us in the CS Class at Ball State in Indiana. And I think on the last day where a graduation eight of us had jobs. That's amazing. And I was one of the eight, so I was really fortunate. So a computer science degree? I start out with a manufacturing company, they basically want insist administration. And I was thrilled to do sister administration. I had a love playing with Unix and hardware like that, and at that point, basically I got there and they said that your new X I was like, Great, I've never heard of it. I can read about it and learn, you know, learned a lot about it and, um had an okay time with that. But it wasn't too long. They realized that they wanted to do a whole lot more Lennox and that I had already had shown a lot of attitude for Lennox and interesting. And so they were like you could do Lennox, too. And then it was more like, Well, you're really just doing Lennox and you're not doing a whole time, which is OK as well.

**Jay Gordon:** It certainly gives you more moderate stuff. Toe work. Yeah, well, you

Michael Stahnke: know, three. It was hard to say. Was Lennox really going to take off the enterprise thing? Because it was in a lot of ways, it was a toy. You didn't have an l V m in limits. At that point, you resize file systems without taking us a server down.

**Jay Gordon:** Yeah, things were still I like the idea of, like, bsg BSD jails a ce faras like open source operating systems in the world were, like the most advanced way of thinking of how to segment stuff without having to put up a new piece of hardware.

Michael Stahnke: Right? Right. And so, you know, we did. I ended up being on a team that was possible for H p U ex ex Solaris, red hat Lennox and a little bit of Susa Lennix. So was this,

**Jay Gordon:** like, kind of your first, like on call involvement? Or did that come later on?

Michael Stahnke: So that was I was on call. I mean, like, you know, probably 12 weeks into the job, got and was interesting was we had just there had been a reward as large companies Do you really? Sure. That's kind of like sneezing. Yeah. So much of these computers came in that the team I was on really didn't know much about the way we just absorbed all the Unix systems from designers and these engineers that were all over building large, large components to construction equipment, stuff like that. And so, uh, there was things that were done differently in different hosts and things, you know, there was just not consistency or anything like that. But, you know, you're on call in. Okay, So my first question was, Well, which things in my own call for And they really couldn't answer that. A

**Jay Gordon:** very difficult part of being on call, right?

Michael Stahnke: I was like, So if I just get a like, if you get a call, answer it. Okay, That seems reasonable. Uh, but how do I know if, like, I'm supposed to take care of this? Like, maybe I just don't have access because I've only been here 12 weeks this point share, like sometimes access

**Jay Gordon:** management doesn't roll out super well. And

Michael Stahnke: at this place, that was very much not ruling out very well, and, you know, I was like, Well, we don't know, you know, call somebody else on the team and see if you're supposed to do it. I was like So then my job on college to answer the phone and call somebody else. They're like,

**Jay Gordon:** yeah, escalation, escalation, pass like that Don't tend to always make a lot of happy employees. So you go few years later, you move forward. I know was just I believe you're a cat at something like

Michael Stahnke: this is this is Caterpillar. I was gonna try to get the the innocents here, but you

**Jay Gordon:** spend time in a caterpillar, and then I think you spend a little time, that's where and then eventually you end up a puppet, and now you're a puppet. During what I would really call a really revolutionary moment in what we call Dev Ops. Now it really just started off. His configuration management service is but to think about how much people from puppet or from chef and all these companies, they helped, I think, promote the Dev ops ideology that we're all kind of like, really embracing and is now less of Ah, it's kind of a thing that some people do. And now it is the standard.

Michael Stahnke: Yeah, Yeah. I mean, it was It was interesting. Before I got the puppet I was really interested in. I realized I was moved to Nashville in 2007 and I knew that Luke had written puppet and lived in Nashville so excited that I was gonna get to probably meet this guy who had done puppet and ended up that I actually was. You know, I thought I'd be, like, really hard to figure out how to meet this dude. I ended up basically working for somebody that was a good friend of Yeah, So it was really simple to meet him and a bunch of spectacular people people in Nashville, but, you know, just kind of got to meet him a couple of other founders of puppet and the way they thought about engineering our systems engineering, it was just different, you know, it was let's take all these practices that developers have had and apply them to operations like why is operations this order taking ticket, taking a firefighting mode? And let's let's take the

**Jay Gordon:** complexities that we've left in operations and let's replace them with the same kind of things that we're using in software development. It's like, you know, repositories, actually keeping things with some sort of revision control. You know, if there's got to be more than just, you know, using our sea and checking things in, there's gotta be a way that everybody can

Michael Stahnke: do it. Yeah, I mean, well, even that if you're using RCS local, you're doing better than most systems teams. That's just That's true, right? And so for them it was a lot of Hey, there's all this tooling and developers or 20 or 25 years ahead of where Operations is. Why is that? He always had operators. Why were they not investing in themselves be better? Well, because they were firefighting the entire time. And, uh, that was just a conversation that really resonated with me. And so, you know, eventually ended up going to work with Puppet and got to ride such a great ride there for eight years. And, you know, through all the hype of Dev office and of configuration management tools and open source kind of taking over. I mean, you know the reason that ruby is as popular as it is in the system space is because of, you know, puppet. Yeah, absolutely. And like that was super fun. So

**Jay Gordon:** when I think about language other than, say, bash that I say I know because of the work. I've done an ops over the last years. It's Ruby. And you know I credit, you know, Adam Jacob, for also being out there and pushing Ruby along with people over a puppet. I thought it really benefited quite a bit, because our speck and eventually all these things that helped make sure that we were writing good Ruby so and then eventually. Now you head over after all your time it, poppet, you're now Circle C I Where Circle C. I is helping people get the most out of their continuous integration and continued continuous deployment on. We'll talk a little bit more about that, but I wanna I wanna first bring up something really important. Okay, So, yesterday I did my talk and one part of my talk that I did, which was about being on call in on call nightmares, is the rules of podcast. And so I must lay out the rules because this is what I do. Um 1st 1 is Do not incriminate yourself. Because if you've got a pretty ugly story and you did something in there, I don't want you to look bad. Don't incriminate others. Because a CZ we do in dev ops nowadays were blameless. And then help us learn Because, like everything we do now in the world of Dev ops operations and, uh, sorry, we do retrospectives. And that's what this whole podcast is. It's a retrospective. So I'd like to give you the opportunity to kind of give me a retrospective on maybe a nasty issue you ran into while you were on call And how you kind of learn from

Michael Stahnke: it. Yeah, so, you know, back. So we were talking about I was responsible for the other team responsible for five different addresses. That Were you expecting style stuff? Um, and we had taken in these servers from a different business unit, you know, they basically tried to centralize opposite when when it was decentralized, and then they re centralized it for the most part. And I was really big into automation. I mean, I had a siesta greedy and so like again, I got to this place doing operations and I was like, This seems like a really inefficient I just don't know how to put it. Like people are having spreadsheets and they're checking off boxes. You know, I change the password on this box. I change the bathroom on the next one, and it's me. I was just like you could just write a loop and like, do this, you know? And I learned about expecting. I learned about a bunch of other like, scripting helpers. I remember those days and like, Okay, so again, I didn't know what I was on call for. So I started making a database of all this stuff, and it was like a lamp stack. You know what I was doing? Php php was not allowed in. The company didn't care. I'm gonna solve my problem around my work station. I didn't even care. Um, but I got the point where I had a lot of feeds where I could just say, give me all the host in this database and then apply this automation stuff, right? And so I did that, and I was I remember what the script was supposed to do, but I had some of that was gonna go hit 405 100 servers and go, you know, probably like removing account. No more advanced in that I don't remember what it was. But a lot of machines, A lot of machines

**Jay Gordon:** big, big, big removal or social change. These

Michael Stahnke: air, like, you know, and many of these servers are, you know, these aren't a little League Lennox one used. These were like $40,000 cake. Last year's boxers, son for 20. Let's just these riel Unix Lennox powerhouses on some of the more, you know, lex boxes doing like engineering coordination. And when I give the word engineering at this company, these two people that literally like a mechanical engineer structural engineers, erlich not technology engineers. Not like right on Java, screw it and compiling things. This is like actually working with mechanical right on dso. There was an injury data center. That was That was one of those places that was absorbed into this this newer group that was formed and no, I write rent some automation and what I have found out about, you know, do a four loop in. So this was one of those classic devout s'more at moments where fails human toe Army failures Delap's. And, uh, I automated it as fast as I could. Uh, so we got through. I think I was up to, like, the letter B. And so host names were alphabetically sorted, right? And something just didn't seem right. Oh, this is taking a lot longer than what it should. So I just you know, I'm gonna hit control C like I hit control. C gonna go. Look, I'm like, I love you. Still have the first server. Can't looking for server. It's going to a second server, counting the seconds ever. It's sort of the third server. Well, you know what? This story is going. It's about 30 servers in Jeez. And what I realized is that I had a variable in a bad script that, for some reason, couldn't resolve on servers that were taken over from that business unit. Like there was a setting that wasn't set again. I don't remember the specifics. I remember. Based on what ended up doing I was supposed to do our m variable named slash star. Turns

**Jay Gordon:** out when the

Michael Stahnke: variable name doesn't resolve slashed Our is where you are end.

**Jay Gordon:** Oh, my. Now just to give you all a little bit of Jason is in the background. He's getting ready for his talk in a little while and he's giggling

Michael Stahnke: silently. And to be honest with you, we're all kind of looking pain because I've written something similar, and I luckily, these were restored with machines, but oh, my God. Okay, so my next question, you know, somebody, like, have this. Oh, shit. Moment. Um, there's about nine o'clock, maybe eight o'clock. And I called my wife, and I said, uh, no, actually, I was No, I wasn't at home where I was in the office 8 30 at night. I don't know. I was, um call my wife and said, Don't wait up. It's gonna be awhile. Um and so, uh, you know, I start looking at these host on Lo Cape. What house are really similar to these, you know, so I could start doing comparisons, cause, like, luckily, not all the arms had finished because I think I like it was like, you know, backgrounding all the tasks. And so, like, I could cancel them very fast, but it wasn't. It wasn't good. And so, you know, some of these I could put in a single years or mode and, like, you know, figure out or whatever. And a lot of times, if you're lucky and you only get rid of the user land like I've been in this situation where, like, you know, you just copy over the land from, like, another machine. So you get the file system that you need and everything, and then turns out okay, Great things were back to normal. Who? But then it always doesn't work that way. Actually, now that now that I'm thinking about this more I r m something and the issue it wasn't only the r m. It was did a recursive Chone visit. Tomato permissions got screwed, so part was removed. And then the removal was not the part that actually screwed up everything. It was it was the permissions. I don't rember ownership in body, but And so I called up my buddies, and he was about his junior as I was on the team. And I was like, Hey, I kind of messed up stuff, love. And he answers, needs like, Hey, dude, what's going on? I was like, Are you drunk? Yeah. He's like you want to help. I was like, Yeah, so? So he drives in. Um, apparently he was Well, I'm not incriminating anybody, but he was probably not. Shouldn't driven. Shouldn't when we say incriminated, we have to do with the actual systems that are involved in these incidents. So that's a separate incrimination. Sir, I please don't drink and drive. Listeners never drink and drive. Yeah. Please don't. It's not sport, uh, and so he can't. He comes in and he's like, Okay, so here's what we can do. He's like, I could get you the list of what rpm's were supposed to be on these house. He's like for the Lennox once she's like for the h P u ex ones. He's like, Were you gonna restore from tape? And I was like, I have no idea how to do that. He's like, I ran backups for two years and I was the high school intern like I got you, so I was like, You're pretty wasted. He's, like, pretty sure I could do backups wasted. It turns out he could totally do backups waste. Uh, and then, uh, and then it was, you know, we start looking at the rpm's, He's like So here's the host. It was pre production that hadn't been Hood named yet. That is all set up. And then that was when I learned, like, all the power of rpm, like you could get, who's supposed to own everything what mom mode, every file skills to be like. And so it was just We started writing these things to parse out one rpm database and didn't go apply everything, which is cool when you know what the ownership and stuff supposed to be. But when you're just missing those files, it's also a problem. So we had to write, like, if this thing is here, copies rpm over from here just before the days of young or after forever, like you were literally just an rpm dependency help copper SUV H and pray. Yeah, and then, yeah, I have a transaction of this, you know, it's 15 rpm's long. I learned how to edit the D B three database for RPM at that point. Like, you know, like we're doing

**Jay Gordon:** all this stuff where you learned it. Just delete the whole building. Yeah, yeah,

Michael Stahnke: a little bit of that too. Um, but the interesting thing was by 12 30. All these hosts, like we're like, I'm pretty sure it's okay. And he's like, I'm pretty sure it's okay. And I said, I didn't get paid for anything. And he goes, I didn't either, because he was the back up that night. And so we really well, do we just go to bed and hope everything works tomorrow morning? And the answer was yes. So we went to bed. I've been there. We go toe in there. So it's like 77 30. We rule of the office the next morning. Apparently, people in Central time started God awful early. And, uh, you know, we get there anything, anything going on like now, everything either. And then, like about noon ticket rolls in and it was Everything's performing way faster. What did you do? So the entire feedback set from the engineers over in the in the engineering area was, I think they're faster now. Whatever. You did a great job and that's the story like here was, you know, took down a bunch of servers mess, simple stuff up, restored some things from backup and basically learned a ton about rpm to go fix a bunch of Lennox box. Cool. So I guess what you learned from this situation is one check

**Jay Gordon:** your burial check your friggin variable and that's I'll

Michael Stahnke: be honest with you. I in my past have done a ah ch own with a minus R and really paid for it because I either had a flag somewhere in regular or

**Jay Gordon:** star you name it. And, um, I think the thing that you really learn from these moments are one. A lot of this

Michael Stahnke: stuff is recoverable. If you spend the time learning like it, see each What's it called when you could go into a A an existing file system? Ch something true? True, You learn a lot about stuff like she is shrewd and how important it was for us pre being able to mount file systems really easily like the thing I think we get from the cloud Now it is that we didn't have about 15 years ago, was the idea like if something sucks, you take the disc out, put another disk on the actual instance, or V m. And then just kind of copy some of the things that you need. But nobody really has the ability back then to say shit. I gotta go ahead and reinstall Lennox. I gotta do all these different things after it just wasn't possible. Yeah, way were able to kick start a few servers way have, like, a whole build infrastructure and all that, but it was still I mean, some of them were not recovered. Like we basically kickstarting rebuilt from scratch way picked all the rpm database stuff on and didn't find. But it was Yeah, we used the best tools. We have the time, and it worked out fine. Uh, you know, But I think what I take away from there is you needed to write a lot of defensive code, right? To make sure that you were doing everything correctly and honestly, that was one of things that really attract me to a better configuration management system was, you know, with something like puppet, you could say these things need to have this owner in this and like it checks. Well, if it's already like that, I'm not even gonna run the operation. You know, it has this m i n sync. If yes, you know, move on or I could run things in a no up mode where you could just tell me. Here's all the things that would have done And you like that you like, Oh, that's not what I actually meant to do, you know? And that type of defensive coating was just something that I hadn't seen at that point. You know, when I was a couple years into being a puppet in a configuration, I mean even talk salt in the early days of thes were things or cfn Geneva. These were software suites or or configuration management sweets that came out there to stop us for fat, fingering and fucking up everything. I really think it's still fat minger with these, but at least you've got some controls. Yeah, I mean, I put a cf engine a lot. Um, at least on the days I was using it. Sure, there was not safety mechanisms with it, and I think that's what was That was one of things that I really liked about puppet. Compared to see, invention was like there was a lot more thought about the model and how you model everything out. CF engine was kind of do these things when you see these things. Sure and that was a little bit partner. But I also I don't know that I ever used a great CF engine installation. Share a sea of engine installation. Just is a general. What up saying is that I guess as configuration management software, when ahead and started to improve, more money went into the actual creation. There have been greater controls, what people can do, test sweets that came a part of it so that you can see what you're doing prior to it actually happening. It's it's important. And I think that I've taken from your story. Is that my God? Sometimes it's It's really nice to throw an echo out there once in a while to like, when you're writing a bash script it like. That's a thing that I now I learned from my years of like if I need to write a bash script that's gonna do some simple just clean up, like I always echo the important parts to make sure is going to do what I want with variables. And the thing is like maybe 15 years ago, I was just like

**Jay Gordon:** I got to get

Michael Stahnke: the shit done, and I guess experience made us a lot more conscientious, like, uh, but also, like Andrew Cliche for likes to call people the conscientious developers that end up becoming great ops people. And I think that puppet chef and the like made us all bit more conscientious of what is going into the servers. Yeah. Yeah. You know, I think after that you kind of after server administration became, I would say, a more thought about discipline. Yes. You know, Then you got into how are we delivering software? How we're delivering value and, like, that's kind of where everything we're up to stack, right. And then that was, uh, like, that was really fun. Time to move through as well. And, you know, on calls very different ones. Like if the pipeline isn't there if you can't ship, is that an on call moment? Is that for some companies, the answer is hell, yes. Yeah, some cos it's like now we'll get it tomorrow when people are back in the office. And that's one thing that I think is a little different from like a classic ops background is when you get into this lake, you know your pipelines, your C I pipelines of the factory floor of your company and he wants you. And if your factories down, do you have, like, hundreds engineer standing around? I hope not. But maybe that's okay. Maybe it's not. And like watching that changes. So now it's more about defense in those types of pipelines, right? Like, how do you get defense defensive coding in those concepts in a resilient pipeline or raising output for testing or delivery? And if the same set of problems applied to a little bit different domain? So we're getting close to lunchtime, and I want to wrap up so that we can have our lunch as everyone who goes to conferences. No vendor lunches air Always wonderful. Uh, sponsored lunches. Thank you. Whoever sponsored lunch today s o. I want to start rolling toward the end of the podcast. In the first question, I'm gonna ask you, um, if you are able to give a piece of advice to person, that's on call right now. What would you give them? If you ever get an alert that you do nothing with like, people would like to say that it's not an actual or it's absolutely actionable. The action is stopped getting the alert and, like, go work with whoever designs, alerts or whatever. And make sure that, like just threshold, Zahra, just, you know, whatever you need to adjust because like no one actually usually is bothered by waking up in the night to solve a real problem. It's not real problem. That's your pistol when its memory C C P. Or memory utilization is at 87. Yeah, it's supposed to be like we wanted to cash memory. That's what Lennox does. That's good. But yeah, that's great. Um, so tell me a little bit about what you're doing. It's Circle C. I know. Well, so I'm running the platform ward, which is basically the part of engineering. It's got s sorry security release, engineering machine execution and job execution on it and more or less like pure circle c i dot com reliability that I owned that you know, the cost of goods I own that security, the platform I own that and so, like you know, it's it's hiring engineers. It's getting people to do the right things there. It's growing, expanding, adding CPU, adding, You know, I do talk to compute to do tests on then there's the other side of engineering that's more about the configuration language. You you're also working with people obviously day today, ensuring that they're comfortable with the engineering environment that they're in. So, yeah, I guess it just goes beyond creating C I c d environments. It's It's creating a great development environment, not just for developers, but for your own people. Yeah, I mean, what we use like you circle see eye to do everything that we d'oh. And and sometimes you know, there's rough edges that you want to file down, or there's something that just doesn't flow right for a certain type of project or whatever, and we fix it when we can. Um, but, you know, I think I think the interesting thing is you watch different companies do different work flow through the system, and C I. C E isn't one path for people. You know. There's some people that built time of 28 minutes like they're crying and another company's crying as well. But one of those crying tears of joy and the other one's crying tears of sorrow because 28 minutes is the wrong time for some other places like Manny's take five days, 28 minutes. I was happiest community. This job works great now, right? And you know, we see customers that all ends of the spectrum. That is really interesting, too. Just work with them and talk about what you're doing and why you're doing it. And then you look at it, you know, like a work flows that have failures in it. And you see some customers that just accept failure, like we just know to go look for the law. And if it's that test that fails, it's probably find some flaky test. Just take out that test when we write that test or, you know, whatever is there and people get complacent with things and stuff like that. But, you know, I work with customers, but I would say right now I've been putting a lot more time with the engineers and kind of bolstering up the platform. We've been through rapid, rapid growth, and so there have been some things that were starting to teeter when it's like a the right volumes air their way. Probably assure these up. I want to hit all the S. L. O s ally objectives that we have And so we keep working out, like this morning way actually through once your failure at some of the back end caches and to see what would happen. Everything was fine. But like you just got to do those things. Now it again. Because the last time I want to learn I don't want to talk about that when that's the real problem, you know what I say? And I'll do this to help wrap us up. One thing that I like to say about chaos, engineering, when you're doing those types of tests is chaos. Engineering is so you know, when you don't know that you don't know. And that's really the best way to put it. Like you help find out the things that you didn't know about because you totally didn't know about it and just you didn't even think about it. And I think that's one of the cool things about modern s. Sorry. And engineering and operations is the fact that we're thinking way, way deeper about this stuff we're not aware of. So, uh, thank you again, Mike. I really appreciate your time. Um, if people want to find you on Twitter, how can they do that? I have stand MMA. I'll spell that sth and A and I am that pretty much any service if you ever want to find cool. Well, thanks a lot. I really appreciate it. I do this when people are doing the podcast live. I want to give you there. There's a loud, silly high five.

**Jay Gordon:** We'll be right back up. Thank way. Also got Josh stopped it. Thank you so much. This was fun to do. I don't get to do a lot of these with people in person. I most of time get to do these over Skype. And so I really got Skype. What? I use, I use zoom. Whatever. Anyhow, I really appreciate you taking part of this with me today. Thank you so much. My All right. 

Thanks so much. Cheers. It was a great interview with Michael. One of the best parts about being part of this community is meeting people like him having conversations and just being part of their stories, telling them with him. So thanks a lot, Michael. I really appreciate that time.. Wrap it up. I'll catch you next time here On-Call Nightmares, where I'll have more of your stories about being on call. Remember, please email me on call Nightmare's at gmail dot com so that I could go ahead, get your story. We'll catch you next time. Thanks a lot.
